@model GenerateurDFUSafir.Models.SECU_PROD
@{
    ViewBag.Title = "Accident";
    Layout = "~/Views/Shared/_Layout.cshtml";
    <link href="~/Content/Accident.css" rel="stylesheet" />

    var message = Session["Message"] as string;
    var messageType = Session["MessageType"] as string;
}

<div id="root"></div>

<script type="text/javascript" src="~/Scripts/alertes.js"></script>

@{
    var reactFiles = System.IO.Directory
        .EnumerateFiles(Server.MapPath("~/Scripts/react/assets"), "index-*.js")
        .Select(Path.GetFileName)
        .ToList();
}

@if (reactFiles.Any())
{
    <script type="module" src="~/Scripts/react/assets/@reactFiles.First()"></script>
}

@using Newtonsoft.Json
<script>
    window.reactData = @Html.Raw(JsonConvert.SerializeObject(Model));

    // Débogage direct pour confirmer la session
    console.log('Session Message:', '@message', 'Session Type:', '@messageType');

    // Afficher le pop-up directement
    @if (!string.IsNullOrEmpty(message))
    {
        @:if (typeof showCustomAlert === 'function') {
        @:    showCustomAlert('@messageType', '@message');
        @:} else {
        @:    console.log('showCustomAlert is not available');
        @:}

        // Nettoyer la session après utilisation
        Session["Message"] = null;
        Session["MessageType"] = null;
    }
</script>